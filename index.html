<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Dashboard Kebakaran 2026</title>
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
<style>
:root{--bg:#0b0e14;--panel:#111726;--text:#eaeaea}
body{margin:0;background:var(--bg);color:var(--text);font-family:Segoe UI,Arial,sans-serif}
h1{margin:10px;font-size:22px;font-weight:900}
h2{margin:8px 12px;font-size:16px;opacity:.9}
.tabs{display:flex;gap:6px;padding:6px 10px;flex-wrap:wrap}
.tab{padding:6px 14px;background:#222;border-radius:20px;cursor:pointer;font-weight:700}
.tab.active{background:#ff5252;color:#111}
.grid{display:grid;gap:8px;padding:8px}
.grid-6{grid-template-columns:repeat(6,1fr)}
.grid-3{grid-template-columns:repeat(3,1fr)}
.grid-4{grid-template-columns:repeat(4,1fr)}
.card{background:var(--panel);border-radius:14px;padding:10px;text-align:center;font-weight:800;position:relative}
.card span{display:block;font-size:30px;margin-top:4px}
.bar{position:absolute;left:0;right:0;bottom:0;height:6px}
.red{background:#ff5252}.orange{background:#ff9800}
.blue{background:#29b6f6}.green{background:#26a69a}
.purple{background:#7c4dff}.teal{background:#00bcd4}
.pink{background:#ec407a}.lime{background:#cddc39}
</style>
</head>
<body>

<h1>ðŸ”¥ DATA KEBAKARAN 2026</h1>
<div class="tabs" id="tabs"></div>

<h2>DATA KEJADIAN KEBAKARAN 2026</h2>
<div class="grid grid-6">
  <div class="card">Jakbar<span id="jb">0</span><div class="bar red"></div></div>
  <div class="card">Jakpus<span id="jp">0</span><div class="bar orange"></div></div>
  <div class="card">Jaksel<span id="js">0</span><div class="bar purple"></div></div>
  <div class="card">Jaktim<span id="jt">0</span><div class="bar blue"></div></div>
  <div class="card">Jakut<span id="ju">0</span><div class="bar green"></div></div>
  <div class="card">Total<span id="total">0</span><div class="bar red"></div></div>
</div>

<h2>Jumlah Terdampak</h2>
<div class="grid grid-3">
  <div class="card">Rumah<span id="rumah">0</span><div class="bar orange"></div></div>
  <div class="card">KK<span id="kk">0</span><div class="bar blue"></div></div>
  <div class="card">Orang<span id="orang">0</span><div class="bar green"></div></div>
</div>

<h2>Jumlah Pengungsian</h2>
<div class="grid grid-3">
  <div class="card">Total<span id="tot">0</span><div class="bar red"></div></div>
  <div class="card">Laki-laki<span id="lk">0</span><div class="bar teal"></div></div>
  <div class="card">Perempuan<span id="pr">0</span><div class="bar pink"></div></div>
</div>

<h2>Jumlah Pasien</h2>
<div class="grid grid-3">
  <div class="card">Pasien Sakit<span id="pasien">0</span><div class="bar orange"></div></div>
</div>

<h2>Jumlah Berdasarkan Kategori Usia</h2>
<div class="grid grid-4">
  <div class="card">Balita L<span id="balital">0</span><div class="bar lime"></div></div>
  <div class="card">Balita P<span id="balitap">0</span><div class="bar lime"></div></div>
  <div class="card">Anak L<span id="anakl">0</span><div class="bar teal"></div></div>
  <div class="card">Anak P<span id="anakp">0</span><div class="bar teal"></div></div>
  <div class="card">Dewasa L<span id="dewasal">0</span><div class="bar blue"></div></div>
  <div class="card">Dewasa P<span id="dewasap">0</span><div class="bar blue"></div></div>
  <div class="card">Lansia L<span id="lansial">0</span><div class="bar purple"></div></div>
  <div class="card">Lansia P<span id="lansiap">0</span><div class="bar purple"></div></div>
</div>

<script>
const SHEETS=[
  {label:"Jan", url:"https://docs.google.com/spreadsheets/d/e/2PACX-1vS4JZD0cxRHeBcSJm0KZMXewwX19RWJL1GrNcn2ZQeyeQpVByaiIyt0_FCPEcaRMA/pub?gid=1241106342&single=true&output=csv"},
  {label:"Feb", url:"https://docs.google.com/spreadsheets/d/e/2PACX-1vS4JZD0cxRHeBcSJm0KZMXewwX19RWJL1GrNcn2ZQeyeQpVByaiIyt0_FCPEcaRMA/pub?gid=1284284298&single=true&output=csv"}
];

const COL_KEYS={
 jenis:"Jenis Kejadian", kota:"Kota",
 rumah:"Jumlah Rumah", kk:"Jumlah KK", orang:"Jumlah Terdampak",
 pengungsi:"Jumlah Pengungsian", lk:"Laki-Laki", pr:"Perempuan",
 sakit:"Jumlah Sakit",
 balitaL:"Balita L", balitaP:"Balita P",
 anakL:"Anak L", anakP:"Anak P",
 dewasaL:"Dewasa L", dewasaP:"Dewasa P",
 lansiaL:"Lansia L", lansiaP:"Lansia P"
};

let bulanAktif=0;
let last={};
const num=v=>parseInt((v||"0").toString().replace(/\D/g,""))||0;

function animate(id,val){
 const e=document.getElementById(id),s=last[id]||0,d=val-s;
 let t0=null;
 function a(ts){
  if(!t0)t0=ts;
  const p=Math.min((ts-t0)/500,1);
  e.innerText=Math.floor(s+d*p);
  if(p<1)requestAnimationFrame(a);
 }
 last[id]=val;requestAnimationFrame(a);
}

function buatTab(){
 const tabs=document.getElementById("tabs");
 tabs.innerHTML="";
 SHEETS.forEach((b,i)=>{
  const t=document.createElement("div");
  t.className="tab"+(i===bulanAktif?" active":"");
  t.innerText=b.label;
  t.onclick=()=>{bulanAktif=i;buatTab();load()};
  tabs.appendChild(t);
 });
}

function load(){
 let c={jb:0,jp:0,js:0,jt:0,ju:0,total:0};
 let d={rumah:0,kk:0,orang:0,tot:0,lk:0,pr:0,pasien:0,
        balital:0,balitap:0,anakl:0,anakp:0,
        dewasal:0,dewasap:0,lansial:0,lansiap:0};

 Papa.parse(SHEETS[bulanAktif].url,{
  download:true,skipEmptyLines:true,
  complete:r=>{
    if(!r.data || r.data.length<2) return;
    const headers=r.data[0].map(h=>h.trim().toLowerCase());
    const idx=Object.fromEntries(headers.map((v,i)=>[v,i]));

    r.data.slice(1).forEach(row=>{
      const jenis=(row[idx[COL_KEYS.jenis.toLowerCase()]||""]||"").toLowerCase();
      if(!jenis.includes("kebakaran")) return;

      const kota=(row[idx[COL_KEYS.kota.toLowerCase()]||""]||"").toLowerCase();
      c.total++;
      if(kota.includes("barat")) c.jb++;
      else if(kota.includes("pusat")) c.jp++;
      else if(kota.includes("selatan")) c.js++;
      else if(kota.includes("timur")) c.jt++;
      else if(kota.includes("utara")) c.ju++;

      d.rumah+=num(row[idx[COL_KEYS.rumah.toLowerCase()]||""]);
      d.kk+=num(row[idx[COL_KEYS.kk.toLowerCase()]||""]);
      d.orang+=num(row[idx[COL_KEYS.orang.toLowerCase()]||""]);
      d.tot+=num(row[idx[COL_KEYS.pengungsi.toLowerCase()]||""]);
      d.lk+=num(row[idx[COL_KEYS.lk.toLowerCase()]||""]);
      d.pr+=num(row[idx[COL_KEYS.pr.toLowerCase()]||""]);
      d.pasien+=num(row[idx[COL_KEYS.sakit.toLowerCase()]||""]);

      d.balital+=num(row[idx[COL_KEYS.balitaL.toLowerCase()]||""]);
      d.balitap+=num(row[idx[COL_KEYS.balitaP.toLowerCase()]||""]);
      d.anakl+=num(row[idx[COL_KEYS.anakL.toLowerCase()]||""]);
      d.anakp+=num(row[idx[COL_KEYS.anakP.toLowerCase()]||""]);
      d.dewasal+=num(row[idx[COL_KEYS.dewasaL.toLowerCase()]||""]);
      d.dewasap+=num(row[idx[COL_KEYS.dewasaP.toLowerCase()]||""]);
      d.lansial+=num(row[idx[COL_KEYS.lansiaL.toLowerCase()]||""]);
      d.lansiap+=num(row[idx[COL_KEYS.lansiaP.toLowerCase()]||""]);
    });

    Object.entries({...c,...d}).forEach(([k,v])=>animate(k,v));
  }
 });
}

buatTab();
load();
setInterval(load,180000);
</script>
</body>
</html>
