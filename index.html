<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

<style>
/* ===== TAB ===== */
#tabs{
  display:flex;
  gap:6px;
  padding:6px;
  background:#0d0f14;
}
.tab{
  padding:8px 14px;
  background:#222;
  color:#fff;
  border-radius:6px;
  cursor:pointer;
  font-weight:600;
}
.tab.active{
  background:#ff5722;
}

/* ===== FIRE DASHBOARD ===== */
#firebar{
  display:flex;
  gap:6px;
  padding:8px;
  background:#111;
}
.firebox{
  flex:1;
  padding:10px;
  border-radius:6px;
  text-align:center;
  font-weight:700;
}
</style>

<!-- TAB BULAN -->
<div id="tabs">
  <div class="tab active" onclick="gantiBulan('jan',this)">Januari</div>
  <div class="tab" onclick="gantiBulan('feb',this)">Februari</div>
</div>

<!-- DASHBOARD -->
<div id="firebar"></div>

<script>
/* ==========================
   DATA BULAN (TINGGAL TAMBAH)
========================== */
const BULAN = {
  jan:"https://docs.google.com/spreadsheets/d/e/2PACX-1vS4JZD0cxRHeBcSJm0KZMXewwX19RWJL1GrNcn2ZQeyeQpVByaiIyt0_FCPEcaRMA/pub?output=csv&gid=1241106342",
  feb:"https://docs.google.com/spreadsheets/d/e/2PACX-1vS4JZD0cxRHeBcSJm0KZMXewwX19RWJL1GrNcn2ZQeyeQpVByaiIyt0_FCPEcaRMA/pub?output=csv&gid=1284284298"
};

const warnaKota={
  "Jakarta Barat":"#ff5252",
  "Jakarta Pusat":"#ffa000",
  "Jakarta Selatan":"#00c853",
  "Jakarta Timur":"#2979ff",
  "Jakarta Utara":"#00bcd4",
  "Kepulauan Seribu":"#ab47bc"
};

function normalKota(k){
  if(!k) return null;
  k=k.toLowerCase();
  if(k.includes("barat")) return "Jakarta Barat";
  if(k.includes("pusat")) return "Jakarta Pusat";
  if(k.includes("selatan")) return "Jakarta Selatan";
  if(k.includes("timur")) return "Jakarta Timur";
  if(k.includes("utara")) return "Jakarta Utara";
  if(k.includes("seribu")) return "Kepulauan Seribu";
  return null;
}

function gantiBulan(key,el){
  document.querySelectorAll(".tab").forEach(t=>t.classList.remove("active"));
  el.classList.add("active");
  loadFire(BULAN[key]);
}

function loadFire(url){
  Papa.parse(url,{
    download:true,
    skipEmptyLines:true,
    complete:(res)=>{
      const rows=res.data.slice(1);
      const hitung={
        "Jakarta Barat":0,
        "Jakarta Pusat":0,
        "Jakarta Selatan":0,
        "Jakarta Timur":0,
        "Jakarta Utara":0,
        "Kepulauan Seribu":0
      };

      rows.forEach(r=>{
        const jenis=(r[3]||"").toLowerCase();
        if(!jenis.includes("kebakar")) return;

        const kota=normalKota(r[7]);
        if(!kota) return;

        hitung[kota]++;
      });

      const bar=document.getElementById("firebar");
      bar.innerHTML="";
      Object.keys(hitung).forEach(k=>{
        const d=document.createElement("div");
        d.className="firebox";
        d.style.background=warnaKota[k];
        d.innerHTML=`ðŸ”¥ ${k}<br>${hitung[k]}`;
        bar.appendChild(d);
      });
    }
  });
}

/* LOAD DEFAULT JANUARI */
loadFire(BULAN.jan);
</script>
