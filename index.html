<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Dashboard Kebakaran 2026</title>

<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

<style>
:root{
  --bg:#0b0e14;
  --panel:#111726;
  --text:#eaeaea;
}
body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  font-family:Segoe UI,Arial,sans-serif;
}
h1{
  margin:10px;
  font-size:22px;
}
.tabs{
  display:flex;
  gap:6px;
  padding:6px 10px;
  flex-wrap:wrap;
}
.tab{
  padding:6px 12px;
  background:#222;
  border-radius:10px;
  cursor:pointer;
  font-weight:700;
}
.tab.active{
  background:#ff5252;
  color:#111;
}

.topbar{
  display:grid;
  grid-template-columns:repeat(6,1fr);
  gap:6px;
  padding:6px;
}
.fire{
  background:var(--panel);
  border-radius:14px;
  padding:12px;
  text-align:center;
  font-weight:900;
}
.fire span{
  display:block;
  font-size:28px;
}

.bottom{
  display:grid;
  grid-template-columns:repeat(7,1fr);
  gap:6px;
  padding:6px;
}
</style>
</head>

<body>

<h1>ðŸ”¥ DATA KEBAKARAN 2026</h1>

<!-- TAB BULAN -->
<div class="tabs" id="tabs"></div>

<!-- REKAP KOTA -->
<div class="topbar">
  <div class="fire">JAKBAR<span id="jb">0</span></div>
  <div class="fire">JAKPUS<span id="jp">0</span></div>
  <div class="fire">JAKSEL<span id="js">0</span></div>
  <div class="fire">JAKTIM<span id="jt">0</span></div>
  <div class="fire">JAKUT<span id="ju">0</span></div>
  <div class="fire">TOTAL<span id="total">0</span></div>
</div>

<!-- DAMPAK -->
<div class="bottom">
  <div class="fire">Rumah<span id="rumah">0</span></div>
  <div class="fire">KK<span id="kk">0</span></div>
  <div class="fire">Orang<span id="orang">0</span></div>
  <div class="fire">Laki-Laki<span id="lk">0</span></div>
  <div class="fire">Perempuan<span id="pr">0</span></div>
  <div class="fire">Balita<span id="balita">0</span></div>
  <div class="fire">Total<span id="totkorban">0</span></div>
</div>

<script>
const CSVs=[
 "https://docs.google.com/spreadsheets/d/e/2PACX-1vS4JZD0cxRHeBcSJm0KZMXewwX19RWJL1GrNcn2ZQeyeQpVByaiIyt0_FCPEcaRMA/pub?output=csv&gid=1241106342",
 "https://docs.google.com/spreadsheets/d/e/2PACX-1vS4JZD0cxRHeBcSJm0KZMXewwX19RWJL1GrNcn2ZQeyeQpVByaiIyt0_FCPEcaRMA/pub?output=csv&gid=1284284298"
];

const bulanNama=["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agu","Sep","Okt","Nov","Des"];
let bulanAktif=new Date().getMonth();

function num(v){
  return parseInt((v||"0").toString().replace(/[^0-9]/g,""))||0;
}

function buatTab(){
  tabs.innerHTML="";
  bulanNama.forEach((b,i)=>{
    const d=document.createElement("div");
    d.className="tab"+(i===bulanAktif?" active":"");
    d.innerText=b;
    d.onclick=()=>{
      bulanAktif=i;
      document.querySelectorAll(".tab").forEach(t=>t.classList.remove("active"));
      d.classList.add("active");
      loadData();
    };
    tabs.appendChild(d);
  });
}

function loadData(){
 let c={jb:0,jp:0,js:0,jt:0,ju:0,total:0};
 let d={rumah:0,kk:0,orang:0,lk:0,pr:0,balita:0,tot:0};

 Promise.all(CSVs.map(u=>new Promise(res=>{
  Papa.parse(u,{download:true,skipEmptyLines:true,complete:r=>res(r.data)});
 }))).then(all=>{
  all.flat().slice(1).forEach(r=>{
    if(!(r[3]||"").toLowerCase().includes("kebakaran"))return;

    const tgl=new Date(r[1]);
    if(tgl.getMonth()!==bulanAktif)return;

    const kota=(r[7]||"").toLowerCase();
    c.total++;
    if(kota.includes("barat"))c.jb++;
    else if(kota.includes("pusat"))c.jp++;
    else if(kota.includes("selatan"))c.js++;
    else if(kota.includes("timur"))c.jt++;
    else if(kota.includes("utara"))c.ju++;

    d.rumah+=num(r[10]);
    d.kk+=num(r[11]);
    d.orang+=num(r[12]);
    d.tot+=num(r[13]);
    d.lk+=num(r[14]);
    d.pr+=num(r[15]);
    d.balita+=num(r[16])+num(r[17]);
  });

  jb.innerText=c.jb; jp.innerText=c.jp; js.innerText=c.js;
  jt.innerText=c.jt; ju.innerText=c.ju; total.innerText=c.total;

  rumah.innerText=d.rumah;
  kk.innerText=d.kk;
  orang.innerText=d.orang;
  lk.innerText=d.lk;
  pr.innerText=d.pr;
  balita.innerText=d.balita;
  totkorban.innerText=d.tot;
 });
}

buatTab();
loadData();
setInterval(loadData,180000);
</script>

</body>
</html>
