<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Dashboard Kebakaran 2026</title>

<style>
:root{
  --bg:#0b0e14;
  --panel:#111726;
  --text:#eaeaea;
}
body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  font-family:Segoe UI,Arial,sans-serif;
}
h1{margin:10px;font-size:22px;font-weight:900}
h2{margin:8px 12px;font-size:16px}

.tabs{display:flex;gap:6px;padding:6px 10px;flex-wrap:wrap}
.tab{
  padding:6px 14px;
  background:#222;
  border-radius:20px;
  cursor:pointer;
  font-weight:700;
}
.tab.active{background:#ff5252;color:#111}

.grid{display:grid;gap:8px;padding:8px}
.grid-6{grid-template-columns:repeat(6,1fr)}
.grid-3{grid-template-columns:repeat(3,1fr)}

.card{
  background:var(--panel);
  border-radius:14px;
  padding:12px;
  text-align:center;
  font-weight:800;
  position:relative;
}
.card span{display:block;font-size:28px;margin-top:4px}
.bar{position:absolute;left:0;right:0;bottom:0;height:5px;background:#ff5252}
</style>
</head>

<body>

<h1>ðŸ”¥ DATA KEBAKARAN 2026</h1>
<div class="tabs" id="tabs"></div>

<div class="grid grid-6">
  <div class="card">Jakbar<span id="jb">0</span><div class="bar"></div></div>
  <div class="card">Jakpus<span id="jp">0</span><div class="bar"></div></div>
  <div class="card">Jaksel<span id="js">0</span><div class="bar"></div></div>
  <div class="card">Jaktim<span id="jt">0</span><div class="bar"></div></div>
  <div class="card">Jakut<span id="ju">0</span><div class="bar"></div></div>
  <div class="card">Total<span id="total">0</span><div class="bar"></div></div>
</div>

<h2>Korban / Meninggal</h2>
<div class="grid grid-3">
  <div class="card">Jumlah<span id="korban">0</span></div>
</div>

<h2>Jumlah Pasien (Sakit)</h2>
<div class="grid grid-3">
  <div class="card">Jumlah<span id="pasien">0</span></div>
</div>

<h2>Jumlah Terdampak</h2>
<div class="grid grid-3">
  <div class="card">Rumah<span id="rumah">0</span></div>
  <div class="card">KK<span id="kk">0</span></div>
  <div class="card">Orang<span id="orang">0</span></div>
</div>

<h2>Jumlah Pengungsian</h2>
<div class="grid grid-3">
  <div class="card">Total<span id="pengTotal">0</span></div>
  <div class="card">Laki-Laki<span id="pengL">0</span></div>
  <div class="card">Perempuan<span id="pengP">0</span></div>
</div>

<script>
const SHEET_ID="1PU8hf7BEu142XSi0QjCMDgPsD6KaSFET";

const GID={
  0:"1241106342",
  1:"1284284298"
};

const bulan=["Jan","Feb"];
let aktif=0;

function num(v){
 if(!v) return 0;
 const x=parseInt(v.toString().replace(/\D/g,""));
 return isNaN(x)?0:x;
}

function buatTab(){
 tabs.innerHTML="";
 bulan.forEach((b,i)=>{
  const d=document.createElement("div");
  d.className="tab"+(i===aktif?" active":"");
  d.innerText=b;
  d.onclick=()=>{
    aktif=i;
    document.querySelectorAll(".tab").forEach(t=>t.classList.remove("active"));
    d.classList.add("active");
    loadData();
  };
  tabs.appendChild(d);
 });
}

function loadData(){
 if(!GID[aktif]) return;

 const url=`https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?gid=${GID[aktif]}&tqx=out:json`;

 fetch(url)
 .then(r=>r.text())
 .then(t=>{
  const json=JSON.parse(t.substring(47,t.length-2));
  const rows=json.table.rows;

  let h={};
  json.table.cols.forEach((col,i)=>{
    h[col.label.trim().toLowerCase()]=i;
  });

  let data={
    jb:0,jp:0,js:0,jt:0,ju:0,total:0,
    korban:0,pasien:0,
    rumah:0,kk:0,orang:0,
    pengTotal:0,pengL:0,pengP:0
  };

  rows.forEach(r=>{
    const c=r.c.map(x=>x?x.v:"");
    const jenis=(c[h["jenis kejadian"]]||"").toLowerCase();
    if(!jenis.includes("kebakaran")) return;

    data.total++;

    const kota=(c[h["kota"]]||"").toLowerCase();
    if(kota.includes("barat")) data.jb++;
    else if(kota.includes("pusat")) data.jp++;
    else if(kota.includes("selatan")) data.js++;
    else if(kota.includes("timur")) data.jt++;
    else if(kota.includes("utara")) data.ju++;

    data.korban += num(c[h["jumlah korban / meninggal"]]);
    data.pasien += num(c[h["jumlah sakit"]]);

    data.rumah  += num(c[h["jumlah rumah"]]);
    data.kk     += num(c[h["jumlah kk"]]);
    data.orang  += num(c[h["jumlah orang"]]);

    data.pengTotal += num(c[h["jumlah total"]]);
    data.pengL     += num(c[h["jumlah laki-laki"]]);
    data.pengP     += num(c[h["jumlah perempuan"]]);
  });

  Object.keys(data).forEach(id=>{
    document.getElementById(id).innerText=data[id];
  });

 });
}

buatTab();
loadData();
</script>

</body>
</html>
